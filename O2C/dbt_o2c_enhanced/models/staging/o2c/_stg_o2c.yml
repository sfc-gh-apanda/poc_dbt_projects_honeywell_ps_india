version: 2

models:
  - name: stg_enriched_orders
    description: |
      **Orders with Customer Enrichment**
      
      Joins FACT_SALES_ORDERS with DIM_CUSTOMER.
      Includes audit columns for tracking.
      
      **Pattern:** VIEW (always current)
    access: protected
    config:
      tags: ['staging', 'orders']
    columns:
      - name: order_key
        description: "Surrogate key (MD5 hash)"
        tests:
          - not_null
      - name: source_system
        description: "Source ERP system"
        tests:
          - not_null
      - name: order_id
        description: "Order ID"
        tests:
          - not_null

  - name: stg_enriched_invoices
    description: |
      **Invoices with Payment Terms Enrichment**
      
      Joins FACT_INVOICES with DIM_PAYMENT_TERMS.
      
      **Pattern:** VIEW
    access: protected
    config:
      tags: ['staging', 'invoices']
    columns:
      - name: invoice_key
        description: "Surrogate key"
        tests:
          - not_null
      - name: order_key
        description: "Related order key"
        tests:
          - not_null

  - name: stg_enriched_payments
    description: |
      **Payments with Bank Account Enrichment**
      
      Joins FACT_PAYMENTS with DIM_BANK_ACCOUNT.
      
      **Pattern:** VIEW
    access: protected
    config:
      tags: ['staging', 'payments']
    columns:
      - name: payment_key
        description: "Surrogate key"
        tests:
          - not_null
      - name: invoice_key
        description: "Related invoice key"
        tests:
          - not_null


