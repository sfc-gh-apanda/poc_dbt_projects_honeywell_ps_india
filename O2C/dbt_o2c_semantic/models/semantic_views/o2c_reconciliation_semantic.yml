version: 2

semantic_views:
  - name: o2c_reconciliation_semantic
    description: |
      Semantic view for Order-to-Cash reconciliation data.
      Enables Cortex Analyst to answer natural language questions about O2C metrics.
    
    model: ref('dm_o2c_reconciliation')
    
    # Time dimension for temporal analysis
    time_dimension:
      name: order_date
      type: date
      description: "Date when the order was placed"
    
    # Dimensions for filtering and grouping
    dimensions:
      - name: source_system
        type: string
        description: "Source ERP system (BRP900, CIP900, EEP300)"
        
      - name: customer_id
        type: string
        description: "Unique customer identifier"
        
      - name: customer_name
        type: string
        description: "Customer company name"
        synonyms:
          - "customer"
          - "company"
          - "account"
        
      - name: customer_type
        type: string
        description: "Customer type: E=External, I=Internal"
        synonyms:
          - "customer category"
          - "account type"
        
      - name: customer_country
        type: string
        description: "Customer country"
        synonyms:
          - "country"
          - "location"
          - "geography"
        
      - name: reconciliation_status
        type: string
        description: "Status: NOT_INVOICED, NOT_PAID, OPEN, CLOSED"
        synonyms:
          - "status"
          - "state"
        
      - name: payment_timing
        type: string
        description: "Payment timing: ON_TIME, LATE, OVERDUE, CURRENT"
        synonyms:
          - "payment status"
          - "timeliness"
        
      - name: invoice_date
        type: date
        description: "Date when invoice was issued"
        
      - name: payment_date
        type: date
        description: "Date when payment was received"
    
    # Measures for aggregation and analysis
    measures:
      - name: total_orders
        type: count_distinct
        expr: order_key
        description: "Total number of unique orders"
        synonyms:
          - "order count"
          - "number of orders"
          - "orders"
        
      - name: total_invoices
        type: count_distinct
        expr: "CASE WHEN invoice_key != 'NOT_INVOICED' THEN invoice_key END"
        description: "Total number of invoices issued"
        synonyms:
          - "invoice count"
          - "number of invoices"
          - "invoices"
        
      - name: total_payments
        type: count_distinct
        expr: "CASE WHEN payment_key != 'NOT_PAID' THEN payment_key END"
        description: "Total number of payments received"
        synonyms:
          - "payment count"
          - "number of payments"
          - "payments"
        
      - name: total_order_value
        type: sum
        expr: order_amount
        description: "Total value of all orders in USD"
        synonyms:
          - "order value"
          - "revenue"
          - "sales"
          - "order amount"
        
      - name: total_invoice_value
        type: sum
        expr: invoice_amount
        description: "Total value of all invoices in USD"
        synonyms:
          - "invoice value"
          - "billed amount"
          - "invoice amount"
        
      - name: total_cash_collected
        type: sum
        expr: payment_amount
        description: "Total cash collected from payments in USD"
        synonyms:
          - "cash collected"
          - "payments received"
          - "collections"
        
      - name: total_ar_outstanding
        type: sum
        expr: outstanding_amount
        description: "Total accounts receivable outstanding in USD"
        synonyms:
          - "AR outstanding"
          - "outstanding receivables"
          - "unpaid invoices"
          - "receivables"
        
      - name: avg_days_sales_outstanding
        type: average
        expr: days_order_to_cash
        description: "Average days from order to cash (DSO)"
        synonyms:
          - "DSO"
          - "average DSO"
          - "days to collect"
          - "collection period"
        
      - name: avg_days_to_invoice
        type: average
        expr: days_order_to_invoice
        description: "Average days from order to invoice"
        synonyms:
          - "billing time"
          - "time to invoice"
        
      - name: avg_days_to_payment
        type: average
        expr: days_invoice_to_payment
        description: "Average days from invoice to payment"
        synonyms:
          - "payment time"
          - "time to payment"
          - "collection time"
        
      - name: avg_days_past_due
        type: average
        expr: days_past_due
        description: "Average days past due date"
        synonyms:
          - "overdue days"
          - "late days"

